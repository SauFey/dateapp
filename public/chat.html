<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>LunaRoom Chatt</title>
  <script src="/socket.io/socket.io.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body class="chat-body">
  <img src="heartlogo.png" alt="LunaRoom Logo" class="logo" />
  <header>
    <div class="logo">LunaRoom ðŸŒ™</div>
    <div class="online-count">64 online (128 i nÃ¤tverket)</div>
  </header>

  <main class="chat-layout">

    <aside class="left-column">
      <h3>Rum</h3>
      <ul class="room-list" id="roomList">
        <li class="active" data-room="Global">Global</li>
        <li data-room="18+">18+</li>
        <li data-room="Tech">Tech</li>
        <li data-room="Hobby">Hobby</li>
      </ul>
      <h3>Privata meddelanden</h3>
      <ul class="private-list" id="privateList">
        <li>Anna</li>
        <li>Lisa</li>
      </ul>
    </aside>

    <section class="chat-center">
      <h2>Global</h2>
      <div id="chatDisplay" class="chat-display"></div>
      <form id="chatForm" class="chat-form">
        <textarea id="chatInput" placeholder="Skriv ett meddelande..."></textarea>
        <button id="sendBtn">Skicka</button>
      </form>
    </section>

    <aside class="right-column">
      <h3>Online just nu</h3>
      <ul class="member-list" id="memberList"></ul>
      <ul class="recent-list" id="recentList"></ul>
      <ul class="member-list">
        <li>Emma</li>
        <li>Julia</li>
      </ul>
      <h3>Nyss lÃ¤mnat</h3>
      <ul class="recent-list">
        <li>Clara</li>
        <li>Elin</li>
      </ul>
    </aside>
  </main>
  <script>
    const nickname = localStorage.getItem('username') || 'vÃ¤n';

    const socket = io();
    const room = 'Global';

    socket.emit('joinRoom', { room, nickname });

    socket.on('message', data => {
      const msg = document.createElement('p');
      msg.innerHTML = `<strong>${data.user}:</strong> ${data.text}`;
      document.getElementById('chatDisplay').appendChild(msg);
      document.getElementById('chatDisplay').scrollTop = document.getElementById('chatDisplay').scrollHeight;
    });

    document.getElementById('chatInput').addEventListener('keydown', function (event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    });

    function sendMessage() {
      const text = document.getElementById('chatInput').value.trim();
      if (!text) return;
      socket.emit('chatMessage', { user: nickname, text });
      document.getElementById('chatInput').value = '';
    }
  </script>
</body>

</html>